## Placeholder for script that would be executed before running container
## To replace this file you should create ./bin/init_script in your s2i context folder. See: `--context-dir` option.

## This file can be used to inject environment variables into the configuration files

## Setup default DNS_SERVER for proxy requests
setup_dns_env_var() {
      if [ -z "$DNS_SERVER" ]; then
            export DNS_SERVER=`cat /etc/resolv.conf | grep "nameserver" | awk '{print $2}' | tr '\n' ' '`
            echo "Using system dns server ${DNS_SERVER}"
      else
            echo "Using user defined dns server: ${DNS_SERVER}"
      fi  
}

## Inject environment variables
inject_env_vars() {
      ## Replace only specified environment variables in specified file.
      envsubst '${DNS_SERVER}
                ${LOG_LEVEL}' < "${NGINX_CONFIGURATION_PATH}/$1" > "${NGINX_CONFIGURATION_PATH}/$1"
}

# setup_dns_env_var
# inject_env_vars "default.conf"